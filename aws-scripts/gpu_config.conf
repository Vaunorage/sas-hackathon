# =============================================================================
# GPU Instance Master Configuration
# =============================================================================
# This file contains ALL settings for AWS GPU instance creation
# Edit this file to customize your environment
#
# Last Updated: 2025-09-11
# Status: TESTED & WORKING âœ…
# =============================================================================

# -----------------------------------------------------------------------------
# AWS CLI Configuration
# -----------------------------------------------------------------------------
AWS_CLI_PATH="../aws-cli/v2/current/dist/aws"
AWS_PROFILE="gpu-test-dev"
AWS_REGION="ca-central-1"
AWS_ACCOUNT="429464666018"  # dev-corpo-service-integration

# -----------------------------------------------------------------------------
# SSH Key Configuration
# -----------------------------------------------------------------------------
KEY_NAME="hackathon-gpu-key"
KEY_FILE="hackathon-gpu-key.pem"
SSH_USERNAME="ec2-user"  # For Amazon Linux 2023

# -----------------------------------------------------------------------------
# Launch Template Configuration
# -----------------------------------------------------------------------------
TEMPLATE_NAME="hackathon-gpu-ssh-template"

# -----------------------------------------------------------------------------
# Instance Configuration
# -----------------------------------------------------------------------------
# AMI: Amazon Linux 2023 with GPU support
AMI_ID="ami-09f66875d9d9c6f79"

# Instance Type: Tesla T4 GPU with 4 vCPUs, 16GB RAM, 15GB GPU RAM
INSTANCE_TYPE="g4dn.xlarge"

# Storage Configuration
EBS_VOLUME_SIZE="20"           # GB
EBS_ENCRYPTED="true"
EBS_DELETE_ON_TERMINATION="true"

# KMS Key for encryption (Beneva-specific)
KMS_KEY_ID="arn:aws:kms:ca-central-1:429464666018:key/47f3f3c0-2782-4b99-9358-3a9b1c490bf7"

# -----------------------------------------------------------------------------
# Network Configuration (CRITICAL for SSH access)
# -----------------------------------------------------------------------------
# Subnet: main-infra-ca-central-1a (PRIVATE IP ONLY - bypasses SSH blocks)
SUBNET_ID="subnet-094a30b24f03d622d"

# Security Group: Beneva-approved group
SECURITY_GROUP="sg-0829722552cd06759"

# Public IP: FALSE (this is KEY to SSH success)
ASSOCIATE_PUBLIC_IP="false"

# -----------------------------------------------------------------------------
# Beneva Organizational Tags (MANDATORY)
# -----------------------------------------------------------------------------
TAG_ENV="dev"
TAG_CENTRE_DE_COUT="CC_94001"
TAG_DOMAINE_AFFAIRES="CORPO"
TAG_DIRECTION="CC_06053"
TAG_SYSTEME="sas"
TAG_CLASSIFICATION_SECURITE="public"
TAG_PROJECT="Actuarial-Cash-Flow-Optimization"

# Instance Name Tag (will appear in AWS Console)
INSTANCE_NAME="GPU-Actuarial-Computing"

# -----------------------------------------------------------------------------
# Metadata Options (Security)
# -----------------------------------------------------------------------------
METADATA_HTTP_TOKENS="required"
METADATA_HTTP_ENDPOINT="enabled"

# -----------------------------------------------------------------------------
# GPU Software Configuration (Post-Launch)
# -----------------------------------------------------------------------------
# NVIDIA Driver packages to install
NVIDIA_PACKAGES="nvidia-release nvidia-driver"

# Python packages for GPU computing
PYTHON_PACKAGES="numpy numba"

# CUDA version (available after driver installation)
CUDA_VERSION="12.9"

# -----------------------------------------------------------------------------
# Configuration Validation
# -----------------------------------------------------------------------------
# Expected results after successful launch:
# - Instance in subnet: subnet-094a30b24f03d622d
# - Private IP in range: 10.117.4.x
# - SSH accessible: ssh -i hackathon-gpu-key.pem ec2-user@<PRIVATE_IP>
# - GPU available: nvidia-smi shows Tesla T4
# - No public IP assigned
# =============================================================================